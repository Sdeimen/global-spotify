---
title: "INFO523 - Decision Trees"
author: "Sebastian Deimen & Noah Giebink"
date: "21 MÃ¤rz 2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# packages

# install.packages("xfun")
library(xfun)
libs <- c("rpart","rpart.plot","tidyverse", "adabag",  "rsample","ipred","randomForest","gbm","DMwR2")
xfun::pkg_attach(libs)

spot <- read.csv("spot_clean.csv")

set.seed(28)
```



```{r}
# preprocessing the data set 

spot <- spot %>% select(track.popularity, track.explicit, danceability, key, loudness, mode, 
                        speechiness, acousticness, instrumentalness,
                        liveness, valence, tempo, country)

# splitting the data, two differnet ways: one with CreateDataPartition, second with sample

# first: 

split_index <- createDataPartition(spot$country, p= 0.8, list = F)

spot_train <- spot[split_index,]
spot_features_test <- spot[-split_index, !(colnames(spot) %in% c("country"))]
spot_target_test <- spot[-split_index, "country"]
  
  
# second:   
  
index <- sample(1:nrow(spot),929)
train <- spot[index,]
test <- spot[-index,]


```


```{r}
# making two trees from different trainings sets

ct_create <- rpartXse(country ~ ., spot_train, se=0.5)
ct_sample <- rpartXse(country ~ ., train, se=0.5)

# prediction using the trees

ps_create <- predict(ct_create, spot_features_test, type = "class")
ps_sampel <- predict(ct_sample, test, type = "class")

# have a look at the variable.importance
ct_create$variable.importance
ct_sample$variable.importance

# contingency tables
cm_create <- table(ps_create, spot_target_test)
cm_sample <- table(ps_sampel,test$country)

# error rate
error_create <- 1-sum(diag(cm_create)/sum(cm_create))
cat("error_create rate:",error_create)
                    
error_sample <- 1-sum(diag(cm_sample)/sum(cm_sample))
cat("error_sample rate:",error_sample)
```





















```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
